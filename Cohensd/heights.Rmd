---
title: "Cohen's d on heights"
author: "Win-Vector LLC"
date: "October 31, 2016"
output:
  md_document:
    variant: markdown_github
---

Data from [Table 7. Height in centimeters for children and adolescents aged 2–19 years and number of examined persons, mean, standard error of the mean, and selected percentiles, by sex and age: United States, 2007–2010](http://www.cdc.gov/nchs/data/series/sr_11/sr11_252.pdf).

```{r}
h <- data.frame(sex=c('Male','Female'),
                n=c(179,118),
                mean=c(177.8,163.4),
                seOfMean=c(0.81,0.72),
                stringsAsFactors = FALSE)
print(h)
pooledSE <- (h[1,'n']*h[1,'seOfMean']+h[2,'n']*h[2,'seOfMean'])/(h[1,'n']+h[2,'n'])
z <- (h[1,'mean']-h[2,'mean'])/pooledSE
print(z)
d <- z/sqrt(h[1,'n']+h[2,'n'])
print(d)

# simulate
set.seed(23525)
popMale <- rnorm(n=h[1,'n'],mean = h[1,'mean'], sd = sqrt(h[1,'n'])*h[1,'seOfMean'])
popFemale <- rnorm(n=h[2,'n'],mean = h[2,'mean'], sd = sqrt(h[2,'n'])*h[2,'seOfMean'])

sumCross <- 0
nCross <- 0
for(a in popMale) {
  for(b in popFemale) {
    sumCross <- sumCross + (a-b)^2
    nCross <- nCross + 1
  }
}
print(sqrt(sumCross/nCross))

sumMale <- 0
nMale <- 0
for(a in popMale) {
  for(b in popMale) {
    sumMale <- sumMale + (a-b)^2
    nMale <- nMale + 1
  }
}
print(sqrt(sumMale/nMale))
print(sd(popMale)*sqrt(2))
print(sqrt(sumCross/nCross)/sqrt(sumMale/nMale))

sumFemale <- 0
nFemale <- 0
for(a in popFemale) {
  for(b in popFemale) {
    sumFemale <- sumFemale + (a-b)^2
    nFemale <- nFemale + 1
  }
}
print(sqrt(sumFemale/nFemale))
print(sd(popFemale)*sqrt(2))
print(sqrt(sumCross/nCross)/sqrt(sumFemale/nFemale))
```

Data from [English men's and women's heights](https://en.wikipedia.org/wiki/Effect_size#Cohen.27s_d) in mm.

```{r}
h <- data.frame(sex=c('Male','Female'),
                n=c(2436,3311),
                mean=c(1750,1612),
                sdOfIndividuals=c(89.93,69.05),
                stringsAsFactors = FALSE)
print(h)
pooledSD <- (h[1,'n']*h[1,'sdOfIndividuals']+h[2,'n']*h[2,'sdOfIndividuals'])/(h[1,'n']+h[2,'n'])
t <- (h[1,'mean']-h[2,'mean'])/(pooledSD/sqrt(h[1,'n']+h[2,'n']))
print(t)
d <- (h[1,'mean']-h[2,'mean'])/pooledSD
print(d)
```
